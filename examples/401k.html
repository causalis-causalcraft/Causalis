
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Impact of 401(k) on Financial Assets &#8212; Causalis 0.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=e0b54744" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=2caa9db7"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=df1d7cd1"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/401k';</script>
    <link rel="icon" href="../_static/new_logo.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/new_logo_big.svg" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/new_logo_big.svg" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">Causalis</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user-guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples.html">
    Real World Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../research.html">
    Research
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/IoannMartynov/Causalis" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user-guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples.html">
    Real World Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../research.html">
    Research
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/IoannMartynov/Causalis" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Impact of...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="impact-of-401-k-on-financial-assets">
<h1>Impact of 401(k) on Financial Assets<a class="headerlink" href="#impact-of-401-k-on-financial-assets" title="Link to this heading">#</a></h1>
<section id="data-explanation">
<h2>Data explanation<a class="headerlink" href="#data-explanation" title="Link to this heading">#</a></h2>
<p>1991 Survey of Income and Program Participation</p>
<ul class="simple">
<li><p><strong>net_tfa</strong> — <em>Net Total Financial Assets</em>.
Calculated as the sum of all liquid and interest-earning assets (IRA balances, 401(k) balances, checking accounts, U.S. savings bonds, other interest‐earning accounts, stocks, mutual funds, etc.) <strong>minus</strong> non‐mortgage debts.</p></li>
<li><p><strong>e401</strong> — <em>401(k) Eligibility Indicator</em>.
Equals 1 if the individual’s employer offers a 401(k) plan; otherwise 0.</p></li>
<li><p><strong>p401</strong> — <em>401(k) Participation Indicator</em>.
Equals 1 if the individual participate in 401(k) plan; otherwise 0.</p></li>
<li><p><strong>age</strong> — <em>Age</em>.
Age of the individual in years.</p></li>
<li><p><strong>inc</strong> — <em>Annual Income</em>.
Annual income of the individual, measured in U.S. dollars for the year 1990.</p></li>
<li><p><strong>educ</strong> — <em>Years of Education</em>.
Number of completed years of formal education.</p></li>
<li><p><strong>fsize</strong> — <em>Family Size</em>.
Total number of persons living in the household.</p></li>
<li><p><strong>marr</strong> — <em>Marital Status</em>.
Equals 1 if the individual is married; otherwise 0.</p></li>
<li><p><strong>twoearn</strong> — <em>Two-Earner Household</em>.
Equals 1 if there are two wage earners in the household; otherwise 0.</p></li>
<li><p><strong>db</strong> — <em>Defined-Benefit Pension Plan</em>.
Equals 1 if the individual is covered by a defined-benefit pension plan; otherwise 0.</p></li>
<li><p><strong>pira</strong> — <em>IRA Participation</em>.
Equals 1 if the individual contributes to an Individual Retirement Account (IRA); otherwise 0.</p></li>
<li><p><strong>hown</strong> — <em>Home Ownership</em>.
Equals 1 if the household owns its home; 0 if renting.</p></li>
</ul>
<p>We download it with fetch_401K function from doubleML.datasets</p>
<p>This dataset has a problem. Cofounders were measured in the same year as treatment and outcome,
like they are demographic factors that do not change over time. So inference might still be biased.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">doubleml.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">fetch_401K</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fetch_401K</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;DataFrame&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># don&#39;t know what they mean</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tw&#39;</span><span class="p">,</span> <span class="s1">&#39;nifa&#39;</span><span class="p">])</span>
<span class="c1"># eligibility for 401k, drop because it&#39;s an instrument</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;e401&#39;</span><span class="p">])</span>

<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;net_tfa&#39;, &#39;age&#39;, &#39;inc&#39;, &#39;fsize&#39;, &#39;educ&#39;, &#39;db&#39;, &#39;marr&#39;, &#39;twoearn&#39;,
       &#39;p401&#39;, &#39;pira&#39;, &#39;hown&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">causalis.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">CausalData</span>
<span class="n">causal_data</span> <span class="o">=</span> <span class="n">CausalData</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">treatment</span><span class="o">=</span><span class="s1">&#39;p401&#39;</span><span class="p">,</span>
                         <span class="n">outcome</span><span class="o">=</span><span class="s1">&#39;net_tfa&#39;</span><span class="p">,</span>
                         <span class="n">confounders</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;fsize&#39;</span><span class="p">,</span> <span class="s1">&#39;educ&#39;</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="s1">&#39;marr&#39;</span><span class="p">,</span> <span class="s1">&#39;twoearn&#39;</span><span class="p">,</span> <span class="s1">&#39;pira&#39;</span><span class="p">,</span> <span class="s1">&#39;hown&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="eda">
<h2>EDA<a class="headerlink" href="#eda" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">causalis.eda</span><span class="w"> </span><span class="kn">import</span> <span class="n">CausalEDA</span>
<span class="n">eda</span> <span class="o">=</span> <span class="n">CausalEDA</span><span class="p">(</span><span class="n">causal_data</span><span class="p">)</span>

<span class="c1"># shape of data</span>
<span class="n">eda</span><span class="o">.</span><span class="n">data_shape</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;n_rows&#39;: 9915, &#39;n_columns&#39;: 11}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1) Outcome statistics by treatment</span>
<span class="n">eda</span><span class="o">.</span><span class="n">outcome_stats</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>p10</th>
      <th>p25</th>
      <th>median</th>
      <th>p75</th>
      <th>p90</th>
      <th>max</th>
    </tr>
    <tr>
      <th>treatment</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7321</td>
      <td>10890.477539</td>
      <td>55256.829173</td>
      <td>-502302.0</td>
      <td>-5427.0</td>
      <td>-1184.0</td>
      <td>200.0</td>
      <td>7399.0</td>
      <td>33500.0</td>
      <td>1462115.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2594</td>
      <td>38262.058594</td>
      <td>79087.535303</td>
      <td>-283356.0</td>
      <td>-1300.0</td>
      <td>3000.0</td>
      <td>15249.0</td>
      <td>45985.5</td>
      <td>98887.4</td>
      <td>1536798.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Participants’ average net worth is ≈28k higher, but this gap cannot be causally attributed
solely to participation. The classes are imbalanced—only 26% are treated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">eda</span><span class="o">.</span><span class="n">outcome_hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/70ddb2baa40dfd121a41763d5d28697dcb6156b6692f581e1690279f6ac7795e.png" src="../_images/70ddb2baa40dfd121a41763d5d28697dcb6156b6692f581e1690279f6ac7795e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">eda</span><span class="o">.</span><span class="n">outcome_boxplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6e11c3e55b8e19db88cf0570f39b3f580751a35e4390b562d785a8f81d5481f9.png" src="../_images/6e11c3e55b8e19db88cf0570f39b3f580751a35e4390b562d785a8f81d5481f9.png" />
</div>
</div>
<p>Our outcome has large right tail</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shows means of confounders for control/treated groups, absolute differences, and SMD values</span>
<span class="n">confounders_balance_df</span> <span class="o">=</span> <span class="n">eda</span><span class="o">.</span><span class="n">confounders_means</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">confounders_balance_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_t_0</th>
      <th>mean_t_1</th>
      <th>abs_diff</th>
      <th>smd</th>
    </tr>
    <tr>
      <th>confounders</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>inc</th>
      <td>32889.802486</td>
      <td>49366.975713</td>
      <td>16477.173227</td>
      <td>0.662197</td>
    </tr>
    <tr>
      <th>hown</th>
      <td>0.589127</td>
      <td>0.765227</td>
      <td>0.176100</td>
      <td>0.383456</td>
    </tr>
    <tr>
      <th>pira</th>
      <td>0.200246</td>
      <td>0.360447</td>
      <td>0.160201</td>
      <td>0.362421</td>
    </tr>
    <tr>
      <th>db</th>
      <td>0.228248</td>
      <td>0.391673</td>
      <td>0.163426</td>
      <td>0.358968</td>
    </tr>
    <tr>
      <th>twoearn</th>
      <td>0.337659</td>
      <td>0.502699</td>
      <td>0.165040</td>
      <td>0.339096</td>
    </tr>
    <tr>
      <th>educ</th>
      <td>12.991121</td>
      <td>13.813416</td>
      <td>0.822294</td>
      <td>0.299061</td>
    </tr>
    <tr>
      <th>marr</th>
      <td>0.574512</td>
      <td>0.690439</td>
      <td>0.115928</td>
      <td>0.242175</td>
    </tr>
    <tr>
      <th>age</th>
      <td>40.900970</td>
      <td>41.509638</td>
      <td>0.608668</td>
      <td>0.060108</td>
    </tr>
    <tr>
      <th>fsize</th>
      <td>2.848108</td>
      <td>2.915960</td>
      <td>0.067852</td>
      <td>0.044731</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Treatment and control are unbalanced on all confounders except age and fsize; nonetheless,
we retain age and fsize in the model to gain efficiency</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Propensity model fit</span>
<span class="n">ps_model</span> <span class="o">=</span> <span class="n">eda</span><span class="o">.</span><span class="n">fit_propensity</span><span class="p">()</span>

<span class="c1"># ROC AUC - shows how predictable treatment is from confounders</span>
<span class="n">roc_auc_score</span> <span class="o">=</span> <span class="n">ps_model</span><span class="o">.</span><span class="n">roc_auc</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC from PropensityModel:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ROC AUC from PropensityModel: 0.7145
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Positivity check - assess overlap between treatment groups</span>
<span class="n">positivity_result</span> <span class="o">=</span> <span class="n">ps_model</span><span class="o">.</span><span class="n">positivity_check</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Positivity check from PropensityModel:&quot;</span><span class="p">,</span> <span class="n">positivity_result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Positivity check from PropensityModel: {&#39;bounds&#39;: (0.05, 0.95), &#39;share_below&#39;: 0.08371154815935451, &#39;share_above&#39;: 0.0, &#39;flag&#39;: True}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SHAP values - feature importance for treatment assignment from confounders</span>
<span class="n">shap_values_df</span> <span class="o">=</span> <span class="n">ps_model</span><span class="o">.</span><span class="n">shap</span>
<span class="n">display</span><span class="p">(</span><span class="n">shap_values_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>shap_mean</th>
      <th>shap_mean_abs</th>
      <th>exact_pp_change_abs</th>
      <th>exact_pp_change_signed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>num__inc</td>
      <td>0.006932</td>
      <td>0.583319</td>
      <td>0.126203</td>
      <td>0.001334</td>
    </tr>
    <tr>
      <th>1</th>
      <td>num__fsize</td>
      <td>0.005461</td>
      <td>0.080593</td>
      <td>0.015778</td>
      <td>0.001050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>num__age</td>
      <td>-0.004583</td>
      <td>0.154312</td>
      <td>0.030720</td>
      <td>-0.000879</td>
    </tr>
    <tr>
      <th>3</th>
      <td>num__marr</td>
      <td>-0.004524</td>
      <td>0.030119</td>
      <td>0.005827</td>
      <td>-0.000868</td>
    </tr>
    <tr>
      <th>4</th>
      <td>num__educ</td>
      <td>-0.003760</td>
      <td>0.121098</td>
      <td>0.023929</td>
      <td>-0.000722</td>
    </tr>
    <tr>
      <th>5</th>
      <td>num__hown</td>
      <td>0.001024</td>
      <td>0.187255</td>
      <td>0.037551</td>
      <td>0.000197</td>
    </tr>
    <tr>
      <th>6</th>
      <td>num__db</td>
      <td>-0.000816</td>
      <td>0.272325</td>
      <td>0.055610</td>
      <td>-0.000157</td>
    </tr>
    <tr>
      <th>7</th>
      <td>num__twoearn</td>
      <td>0.000228</td>
      <td>0.043159</td>
      <td>0.008376</td>
      <td>0.000044</td>
    </tr>
    <tr>
      <th>8</th>
      <td>num__pira</td>
      <td>0.000038</td>
      <td>0.129544</td>
      <td>0.025647</td>
      <td>0.000007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Propensity score overlap graph</span>
<span class="n">ps_model</span><span class="o">.</span><span class="n">plot_m_overlap</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cee310cd1c51350eb01d14ed797326d7e05b78da91a1b3a61fe44216c39090fb.png" src="../_images/cee310cd1c51350eb01d14ed797326d7e05b78da91a1b3a61fe44216c39090fb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Outcome model fit</span>
<span class="n">outcome_model</span> <span class="o">=</span> <span class="n">eda</span><span class="o">.</span><span class="n">outcome_fit</span><span class="p">()</span>

<span class="c1"># RMSE and MAE of regression model</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outcome_model</span><span class="o">.</span><span class="n">scores</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;rmse&#39;: 60189.944724760215, &#39;mae&#39;: 20331.55384475013}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2) SHAP values - feature importance for outcome prediction from confounders</span>
<span class="n">shap_outcome_df</span> <span class="o">=</span> <span class="n">outcome_model</span><span class="o">.</span><span class="n">shap</span>
<span class="n">display</span><span class="p">(</span><span class="n">shap_outcome_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>shap_mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>inc</td>
      <td>731.774932</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pira</td>
      <td>-683.388458</td>
    </tr>
    <tr>
      <th>2</th>
      <td>age</td>
      <td>370.619026</td>
    </tr>
    <tr>
      <th>3</th>
      <td>marr</td>
      <td>-189.688960</td>
    </tr>
    <tr>
      <th>4</th>
      <td>educ</td>
      <td>-133.732826</td>
    </tr>
    <tr>
      <th>5</th>
      <td>twoearn</td>
      <td>-106.324198</td>
    </tr>
    <tr>
      <th>6</th>
      <td>fsize</td>
      <td>68.288189</td>
    </tr>
    <tr>
      <th>7</th>
      <td>db</td>
      <td>-32.271609</td>
    </tr>
    <tr>
      <th>8</th>
      <td>hown</td>
      <td>-25.276096</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="inference">
<h2>Inference<a class="headerlink" href="#inference" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">causalis.inference.ate</span><span class="w"> </span><span class="kn">import</span> <span class="n">dml_ate</span>

<span class="c1"># Estimate Average Treatment Effect (ATE)</span>
<span class="n">ate_result</span> <span class="o">=</span> <span class="n">dml_ate</span><span class="p">(</span><span class="n">causal_data</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">confidence_level</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ate_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coefficient&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ate_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;p_value&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ate_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;confidence_interval&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11250.6922050985
4.0745185003743245e-13
(8210.458854591107, 14290.925555605892)
</pre></div>
</div>
</div>
</div>
<p>Average Treatment Effect is significant and equals 11385 dollars in CI bounds (8674, 14096)</p>
</section>
<section id="refutation">
<h2>Refutation<a class="headerlink" href="#refutation" title="Link to this heading">#</a></h2>
<section id="overlap-validation">
<h3>Overlap validation<a class="headerlink" href="#overlap-validation" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w">  </span><span class="nn">causalis.refutation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="n">rep</span> <span class="o">=</span> <span class="n">run_overlap_diagnostics</span><span class="p">(</span><span class="n">res</span><span class="o">=</span><span class="n">ate_result</span><span class="p">)</span>
<span class="n">rep</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>value</th>
      <th>flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>edge_0.01_below</td>
      <td>0.000000</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>edge_0.01_above</td>
      <td>0.000000</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>edge_0.02_below</td>
      <td>0.026828</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>edge_0.02_above</td>
      <td>0.000000</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>KS</td>
      <td>0.307200</td>
      <td>YELLOW</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AUC</td>
      <td>0.706812</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ESS_treated_ratio</td>
      <td>0.365399</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ESS_control_ratio</td>
      <td>0.893936</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>tails_w1_q99/med</td>
      <td>33.171484</td>
      <td>YELLOW</td>
    </tr>
    <tr>
      <th>9</th>
      <td>tails_w0_q99/med</td>
      <td>5.250310</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>ATT_identity_relerr</td>
      <td>0.069338</td>
      <td>YELLOW</td>
    </tr>
    <tr>
      <th>11</th>
      <td>clip_m_total</td>
      <td>0.009783</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>calib_ECE</td>
      <td>0.026384</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>calib_slope</td>
      <td>0.765845</td>
      <td>YELLOW</td>
    </tr>
    <tr>
      <th>14</th>
      <td>calib_intercept</td>
      <td>-0.197527</td>
      <td>GREEN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We find no evidence of a violation of the overlap (positivity) assumption.</p>
</section>
<section id="score-validation">
<h3>Score validation<a class="headerlink" href="#score-validation" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">causalis.refutation.score.score_validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_score_diagnostics</span>
<span class="n">rep_score</span> <span class="o">=</span> <span class="n">run_score_diagnostics</span><span class="p">(</span><span class="n">res</span><span class="o">=</span><span class="n">ate_result</span><span class="p">)</span>
<span class="n">rep_score</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>value</th>
      <th>flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>se_plugin</td>
      <td>1551.167968</td>
      <td>NA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>psi_p99_over_med</td>
      <td>36.192430</td>
      <td>RED</td>
    </tr>
    <tr>
      <th>2</th>
      <td>psi_kurtosis</td>
      <td>263.310341</td>
      <td>RED</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max_|t|_g1</td>
      <td>3.951050</td>
      <td>YELLOW</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max_|t|_g0</td>
      <td>2.472043</td>
      <td>YELLOW</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max_|t|_m</td>
      <td>1.875749</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>oos_tstat_fold</td>
      <td>0.000028</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>oos_tstat_strict</td>
      <td>0.000028</td>
      <td>GREEN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We see that psi_p99_over_med and psi_kurtosis are RED. That’s because large tail in outcome. We find no evidence of anomaly score behavior</p>
</section>
<section id="sutva">
<h3>SUTVA<a class="headerlink" href="#sutva" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">print_sutva_questions</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.) Are your clients independent (i)?
2.) Do you measure confounders, treatment, and outcome in the same intervals?
3.) Do you measure confounders before treatment and outcome after?
4.) Do you have a consistent label of treatment, such as if a person does not receive a treatment, he has a label 0?
</pre></div>
</div>
</div>
</div>
<p>1.) Yes<br />
2.) Yes<br />
3.) No. We have problems with design<br />
4.) Yes<br />
In conclusion cofounders are measured not before treatment. So treatment affected cofounders</p>
</section>
<section id="uncofoundedness">
<h3>Uncofoundedness<a class="headerlink" href="#uncofoundedness" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">causalis.refutation.unconfoundedness.uncofoundedness_validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_unconfoundedness_diagnostics</span>

<span class="n">rep_uc</span> <span class="o">=</span> <span class="n">run_unconfoundedness_diagnostics</span><span class="p">(</span><span class="n">res</span><span class="o">=</span><span class="n">ate_result</span><span class="p">)</span>
<span class="n">rep_uc</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>value</th>
      <th>flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>balance_max_smd</td>
      <td>7.606060e-02</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>balance_frac_violations</td>
      <td>0.000000e+00</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ess_treated_ratio</td>
      <td>3.653986e-01</td>
      <td>RED</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ess_control_ratio</td>
      <td>8.939358e-01</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>w_tail_ratio_treated</td>
      <td>1.218068e+13</td>
      <td>RED</td>
    </tr>
    <tr>
      <th>5</th>
      <td>w_tail_ratio_control</td>
      <td>2.482226e+00</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>top1_mass_share_treated</td>
      <td>2.137807e-01</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>top1_mass_share_control</td>
      <td>3.937273e-02</td>
      <td>GREEN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ks_m_treated_vs_control</td>
      <td>3.071998e-01</td>
      <td>YELLOW</td>
    </tr>
    <tr>
      <th>9</th>
      <td>pct_m_outside_overlap</td>
      <td>9.783157e-01</td>
      <td>GREEN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We see w_tail_ratio_treated and ess_treated_ratio are RED. It’s ok. These tests are unstable due to small sample</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">causalis.refutation.unconfoundedness.uncofoundedness_validation</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">sensitivity_analysis</span><span class="p">,</span> <span class="n">sensitivity_benchmark</span>
<span class="p">)</span>

<span class="n">sensitivity_analysis</span><span class="p">(</span><span class="n">ate_result</span><span class="p">,</span> <span class="n">cf_y</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">cf_d</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">use_signed_rr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;theta&#39;: 11250.6922050985,
 &#39;se&#39;: 1551.1679676200004,
 &#39;level&#39;: 0.95,
 &#39;z&#39;: 1.959963984540054,
 &#39;sampling_ci&#39;: (8210.458854591107, 14290.925555605892),
 &#39;theta_bounds_confounding&#39;: (10298.960958424657, 12202.423451772342),
 &#39;bias_aware_ci&#39;: (7258.727607917263, 15242.656802279736),
 &#39;max_bias&#39;: 951.7312466738426,
 &#39;sigma2&#39;: 3589568447.751854,
 &#39;nu2&#39;: 0.37645320639967106,
 &#39;params&#39;: {&#39;cf_y&#39;: 0.01, &#39;cf_d&#39;: 0.01, &#39;rho&#39;: 1.0, &#39;use_signed_rr&#39;: True}}
</pre></div>
</div>
</div>
</div>
<p>Even when we have unobserved cofounder with these parameters our CI bounds &gt; 0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivity_benchmark</span><span class="p">(</span><span class="n">ate_result</span><span class="p">,</span> <span class="n">benchmarking_set</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ioannmartynov/PycharmProjects/Ckit/causalis/data/causaldata.py:108: UserWarning: Found 112 duplicate rows out of 9915 total rows in the DataFrame. This leaves 9803 unique rows for analysis. Duplicate rows may affect the quality of causal inference results. Consider removing duplicates if they are not intentional.
  self._check_duplicate_rows(self.df)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cf_y</th>
      <th>cf_d</th>
      <th>rho</th>
      <th>theta_long</th>
      <th>theta_short</th>
      <th>delta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>p401</th>
      <td>0.000041</td>
      <td>0.000004</td>
      <td>-1.0</td>
      <td>11250.692205</td>
      <td>14355.071728</td>
      <td>-3104.379523</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And even when unobserved cofounder is strong as ‘inc’ - income our estimate has CI bounds &gt; 0</p>
</section>
</section>
<section id="conclution">
<h2>Conclution<a class="headerlink" href="#conclution" title="Link to this heading">#</a></h2>
<p>There are problems with design: cofounders are measured not before treatment. So treatment affected cofounders.
However estimate is robust and in real life participation in 401k is increasing net financial assets. To keep in mind real CI bounds may differ from our estimation</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-explanation">Data explanation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inference">Inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#refutation">Refutation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap-validation">Overlap validation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#score-validation">Score validation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sutva">SUTVA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uncofoundedness">Uncofoundedness</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclution">Conclution</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Causalis Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>